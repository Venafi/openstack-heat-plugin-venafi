# http://docs.openstack.org/developer/heat/template_guide/hot_spec.html#heat-template-version
heat_template_version: 2014-10-16


description: >
   Venafi testing certificate

parameters:
  common_name:
    type: string
    label: Common Name
    description: Name of key-pair to be used for compute instance
    default: 'fake.cert.example.com'
  tpp_user:
    type: string
    default: ""
  tpp_password:
    type: string
    default: ""
    hidden: true
  venafi_url:
    type: string
    default: ""
  trust_bundle:
    type: string
    default: ""
  zone:
    type: string
    default: "Default"
  fake:
    type: boolean
    default: "false"
  save_private_key:
    type: boolean
    default: "true"

resources:
  venafi_certificate:
    type: OS::Nova::VenafiCertificate
    properties:
      name: 'venafi certificate'
      zone: { get_param: zone }
      common_name: { get_param: common_name }
      venafi_url: { get_param: venafi_url }
      tpp_user: { get_param: tpp_user }
      tpp_password: { get_param: tpp_password }
      fake: { get_param: fake }
      trust_bundle: { get_param: trust_bundle }
      save_private_key: { get_param: save_private_key }

outputs:
  venafi_certificate:
    value: { get_attr: [venafi_certificate, certificate] }
  venafi_chain:
    value: { get_attr: [venafi_certificate, chain] }
  venafi_pkey:
    value: { get_attr: [venafi_certificate, private_key] }